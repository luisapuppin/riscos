{% extends 'riscos/base.html' %} {% block main_content %}
<div class="jumbotron" style="padding-bottom: 20px; margin-bottom: 1.25rem;">
    {% include "riscos/piloto.html" %}
</div>
<style>
    svg {
        width: 80px; height: 80px;
        transform: rotate(-90deg);
        background: yellowgreen;
        border-radius: 50%;
    }

    circle {
        fill: #655;
        stroke:indianred;
        stroke-width: 32;
        stroke-dasharray: 38 100; /* for 38% */
    }
    
    .card-body {
        padding-top: 30px;
        padding-bottom: 10px;
    }
</style>

<div class="container">
    <h4 class = "text-center">CGCO</h3>
    <div class="card-deck">
        <div class="card bg-primary">
            <div class = "card-body text-center">
                <h1 class = "card-text">{{ processos|length }}</h3>
                <h4 class = "card-text">processos</h4>
            </div>
        </div>
        <div class="card bg-warning">
            <div class = "card-body text-center">
                <h1 class = "card-text">{{ riscos|length }}</h3>
                <h4 class = "card-text">riscos</h4>
            </div>
        </div>
        <div class="card">
            <div class = "card-body text-center" style = "padding-top: 15px;">
                <svg viewBox="0 0 32 32">
                    <circle r="16" cx="16" cy="16" />
                </svg>
                <h4 class = "card-text">riscos graves</h5>
            </div>
        </div>
    </div>
    <br/>
    
    {% for tratamento in tratamentos %}
    <div class = "alert alert-danger">
        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
        Faltam <strong>2 dias</strong> para entregar {{tratamento}}
    </div>
    {% endfor %}
    
    <br/>

    <div class = "busca">
        <div class="card">
            <h5 class="card-title pull-left left">Processos &nbsp;
                <a href="javascript:modal_macroprocesso();">
                    <i class="fas fa-plus-circle" style="color:red;"></i>
                </a>
            </h5>
            <div class="arvore">
                <ul>
                <!--for i in processos-->
                {% for processo in processos%}
                    <li>
                        {{processo}} &nbsp;
                        <a href="{% url 'riscos:detalhar_processo' target_id=processo.pk %}">
                            <i class="far fa-list-alt" style="font-size:1.25em"></i>  &nbsp;
                        </a>
                        <a href="{% url 'riscos:criar_atividade' parent_id=processo.pk %}">
                            <i class="fas fa-plus-circle" style="color:green;font-size:1.25em;"></i> &nbsp;
                        </a> 
                        <a href="{% url 'riscos:criar_risco' parent_id=processo.pk %}">
                            <i class="fas fa-plus-circle" style="color:red;font-size:1.25em;"></i>
                        </a>
                    </li>
                    <ul>
                    {% for risco in riscos %}
                    {% if risco.id_processo == processo %}
                        <li>
                            {{risco}} &nbsp;
                            <a href="{% url 'riscos:detalhar_risco' target_id=risco.pk %}">
                                <i class="far fa-list-alt" style="font-size:1.25em"></i> &nbsp;
                            </a>
                            <a href="{% url 'riscos:criar_tratamento' parent_id=risco.pk %}">
                                <i class="fas fa-plus-circle" style="color:red;font-size:1.25em;"></i>
                            </a>
                        </li>
                        <ul>
                        {% for tratamento in tratamentos %}

                            {% if tratamento.id_causa_consequencia.id_risco == risco %}
                                <li>
                                    {{tratamento}} &nbsp;
                                    <a href="{% url 'riscos:detalhar_tratamento' target_id=tratamento.pk %}">
                                        <i class="far fa-list-alt" style="font-size:1.25em"></i>
                                    </a>
                                </li>
                            {% endif %}
                        {% endfor %}
                        </ul>
                    {% endif %}
                    {% endfor %}
                    </ul>
                    <br/>
                {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    
<br/>
</div>
<script>
    const modal_macroprocesso = () => {
        console.log("Um dia isso ir√° abrir um modal.")
    }
</script>

{% endblock %}